use aliases
#alias Furnace d0
#alias FuelPomp d1
#alias InputAnalizer d2
#alias CoolVent d3
#alias WasteVent d4
const MaxTemp = 995
const Mintemp = 955
const MaxPressure = 29500
const MinPressure = 25500
const RecipeHash = 1579842814
const MaxFurnacePressure = 60000

main:
    var tempOut = 0
    var pressureOut = 0
    Reset()

    var pressure = d0.Pressure
    var temp = d0.Temperature
    while pressure <= MaxFurnacePressure
        d0.SettingInput = 100
        var fuelPressure = d2.Pressure
        if fuelPressure <= 10
            TickFuel()
        end
        d0.Activate = 1

        tempOut = Mintemp
        while tempOut <= MaxTemp
            pressureOut = pressure * tempOut / temp
            if pressureOut > MinPressure
                if pressureOut < MaxPressure
                    j whileend
                end
            end
            tempOut = tempOut + 5
        end

        pressure = d0.Pressure
        temp = d0.Temperature
    end
    whileend:
    d0.SettingInput = 0

    temp = d0.Temperature
    if temp > MaxTemp
        CoolGas()
    end

    var recipeHash = d0.RecipeHash
    if recipeHash == RecipeHash
        d0.Open = 1
        d0.Open = 0
        yield
    end
    db.On = 0
j main

function CoolGas
    pressure = d2.Pressure
    while pressure > 1
        d4.On = 1
        pressure = d2.Pressure
    end
    d4.On = 0
    yield

    pressure = d0.Pressure
    while pressure > 1
        d0.SettingOutput = 100
        pressure = d0.Pressure
    end
    d0.SettingOutput = 0
    yield

    temp = d2.Temperature
    while temp > tempOut
        d3.On = 1
        temp = d2.Temperature
    end
    d3.On = 0
    yield


    pressure = d2.Pressure
    while pressure > 1
        d0.SettingInput = 100
        pressure = d2.Pressure
    end
    d0.SettingInput = 0
    yield
end

function Reset
    d0.SettingInput = 0
    d0.SettingOutput = 0
    d1.On = 0
    d3.On = 0
    d4.On = 0
    yield
end

function TickFuel
    d1.Setting = 100
    d1.On = 1
    yield
    yield
    d1.On = 0
    d0.On = 1
end